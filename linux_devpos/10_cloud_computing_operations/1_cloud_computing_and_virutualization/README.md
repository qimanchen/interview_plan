# 云计算与虚拟化
- 云计算概念
	IaaS - 基础设施即服务
		将物理资源进行整合，通过网络的方式提供虚拟资源
		物理资源 - 服务器，存储，网络
		虚拟资源 - 整合了虚拟CPU，虚拟内存，虚拟磁盘及虚拟网络的虚拟机
		用户可以按需随时创建和释放虚拟机
	PaaS - 平台即服务
		为开发人员提供构建应用程序和服务的平台
		为开发，测试和管理软件应用程序提供按需开发环境
	SaaS - 软件即服务
		互联网提供按需软件付费应用程序，云计算提供商托管和管理软件应用程序
	云计算平台组成
		- 用户界面
			用于云用户传递信息，互动界面
		- 服务目录
			提供永不选择的列表
		- 管理系统
			对应用价值较高的资源进行管理
		- 部署工具
			根据用户请求对资源进行有效部署与匹配
		- 监控
			对云系统上的资源进行管理与控制并制定措施
		- 服务器集群
			虚拟服务器，物理服务器 - 管理系统
- 虚拟化技术漫谈
	通过虚拟机监控器-VMM的程序在物理硬件上生成许多可以独立操作系统软件的虚拟机
	
	- 虚拟化技术的分类
		- 平台虚拟化
			针对计算机和操作系统的虚拟化
		- 资源虚拟化
			针对特定的系统资源的虚拟化，如内存，存储，网络资源
		- 应用程序虚拟化
			仿真，模拟，解释技术
		通常说的虚拟化指的是平台虚拟化
			-通过控制程序（Virtual Machine Monitor或Hypervisor),隐藏特定计算平台实际物理
			特性，为用户提供抽象的，统一的，模拟的计算环境（虚拟机）
			- 虚拟机中运行的操作系统被称为客户机操作系统(Guest OS)
			- 运行虚拟机监控器的操作系统被称为主机操作系统(Host OS)
	- 平然虚拟化又可以分为下面几个子类
		- 全虚拟化
		- 超虚拟化
		- 硬件辅助虚拟化
		- 部分虚拟化
		- 操作系统级虚拟化
- Linux内核虚拟机
	- 全虚拟化
		- 系统管理程序或虚拟机监控器(VMM)
			在虚拟化的操作系统和硬件之间存在一个层，用于决定访问
	- 准虚拟化
		系统管理程序以一种更具有协作性的方式进行操作
	- 虚拟化工作原理
		user-space(applications)|	user-space(applications)
		Guest OS(Virtual machine)|	Guest OS(Virtual machine)
		Hypervisor(Virtual machine monitor)
		Hardware
	- KVM系统管理程序
		简单的加载内核模块而将Linux内核转换成一个系统管理程序 - /dev/kvm
		它可以启用内核的客户模式
		KVM会简单将Linux内核转换成一个系统管理程序
		QEMU进程（执行每个客户操作系统进程的一个拷贝）I/O
		KVM引入了一种除内核和用户模式的新进程模式 - 客户模式
			/dev/kvm 提供内存虚拟化，每个客户操作系统拥有自己的地址空间
	- 实例化新客户操作系统
		/proc/cpuinfo - vmx(Intel),svm(AMD)
	优点：
		KVM需要修改较少，可以将标准内核转换成一个系统管理程序
		它是内核的一部分，可以利用内核的优化和改进
	缺点
		需要较新的能够支持虚拟化的处理器
		一个用户空间的QEMU进程提供I/O虚拟化
		
- 虚拟化
	- 概述
		企业领域采用的虚拟化技术多是服务器虚拟化，需要硬件的支持
		开源，Xen KVM
		- QEMU在用户态
			可以使用KVM内核模块加速
		- KVM在内核态
			需要使用QEMU运行虚拟机
- 虚拟化管理
	1. 物理资源：计算资源（服务器），存储资源，网络资源
		- 云是一个资源池
		- 服务器加入资源池
		- 服务器从云资源池中移除
		- 云所使用的物理存储的架构模式
			- 分布式文件系统
				通过多台存储服务器构建成分布式文件系统
				存储虚拟机的虚拟硬盘
				提供运行虚拟机计算服务器使用
				提供数据冗余功能，保证单个存储点挂掉时数据可用
				ceph
					通过存储系统挂载到每个计算服务器上，并添加到云平台管理进行统一管理
				moosefs
	2. 虚拟资源：虚拟机（虚拟CPU，虚拟硬盘，虚拟内存），镜像，模板，虚拟网络
		- 物理的网络环境在机房中分层设置
		- 云平台则需要对物理网络到虚拟网络的映射关系进行管理
	- 私有云部署
		直接使用OpenStack这类的私有云软件平台提供添加和移除服务器的功能
		存储，直接使用服务器本地硬盘，或单间分布式文件系统
		使用OpenStack的镜像管理组件对虚拟机的镜像进行管理
	- 虚拟资源管理
		- 镜像管理
			- 镜像用来创建虚拟机的磁盘
			- 镜像本身是一个虚拟磁盘
			- 虚拟磁盘格式
				- RAW
				- ISO
				- QCOW2
					KWM/QEMU通常选用
					这个格式可以通过快照的方式创建新的磁盘，省去复制磁盘文件的时间
		- 模板管理
			模板是一个虚拟机的基本配置，包含磁盘镜像及CPU个数，内存大小
		- 虚拟机管理
	